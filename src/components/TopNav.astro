---
import { getNav, type SiteLang } from "../lib/site";
import { withBase } from "../lib/path";

type Props = {
  lang: SiteLang;
  currentPath: string;
};

const { lang, currentPath } = Astro.props;
const items = getNav(lang);

const isActive = (href: string) => {
  if (href === "/") {
    return currentPath === "/";
  }
  return currentPath === href || currentPath.startsWith(`${href}/`);
};

const switchPath = lang === "zh" ? currentPath.replace(/^\/zh/, "") || "/" : `/zh${currentPath === "/" ? "" : currentPath}`;
---

<header class="top-nav-wrap">
  <nav class="top-nav">
    {
      items.map((item) => (
        <a href={withBase(item.href, import.meta.env.BASE_URL)} class:list={["top-nav-link", { active: isActive(item.href) }]}>
          {item.label}
        </a>
      ))
    }
  </nav>
  <a href={withBase(switchPath, import.meta.env.BASE_URL)} class="lang-switch">{lang === "zh" ? "EN" : "\u4e2d\u6587"}</a>
</header>


